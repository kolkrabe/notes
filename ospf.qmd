---
title: "OSPF"
editor: visual
code-block-bg: dark
---

# General Notes

-   Link State Routing Protocol - makes routing decisions based on the state of links.

-   Once adjacency formed each router has the same **Link State Database.**

-   Reacts only to changes, no constant flooding of updates.

-   AD - 110 for Internal & External

-   Process-ID - **Locally** significant.

-   Timers (Default - dead = 4 x Hello)

    -   Hello - 10
    -   Dead Interval - 40 (How long local router waits to hear neighbours Hello
    -   Wait Timer - 40 (How long to wait for DR/BDR to be elected before triggering election)
    -   Retransmit - 5 (how long to wait to retransmit OSPF packet which hasn't been acknowledged)

-   224.0.0.5 - Broadcast for All OSPF Routers (Broadcast), **Port 89**

-   224.0.0.6 - Broadcast for All Designates Routers, **Port 89**

-   Neighbourship Requirements

    -   Matching Area
    -   Matching Auth Parameters
    -   Matching Subnet
    -   Matching Timers
    -   Matching Stub Flags
    -   Matching MTU (Exstart/Exchange State)

-   **DR/BDR Election** - Highest Priority value (0 to remove from election) - Highest Router-ID - Highest IP on Loopback Int - Highest IP on interface that's UP

-   **Metric Calculation**

    -   Bandwidth \\ References Bandwidth - Default ref is 100Mb (all interfaces \> 100M have same ref cost.
        -   Change ref bandwith with `auto-cost reference bandwidth [value]` big kev recommends 2TB!
        -   Should match across topology but won't stop neighbourships forming.

-   Network Type (don't have to match)

    -   Broadcast - ethernet -Default for OSPF - DR/BDR
    -   Point-to-Point - Default for non-Frame Relay serial interface, no DR/BDR required
    -   NBMA - Frame Relay - DR/BDR required, no broadcasts or multicasts, Neighbours must be manually configured. (Hello 30 seconds)
    -   Point-to-Multipoint - No DR/BDR required, hello 30 secs
    -   When mixing - might have to adjust timers.

-   **LSAs**

    -   **Type 1 - Router LSA** (Intra-Area)

        -   Generated by **all OSPF routers**, area local scope, shares directly connected neighbours

    -   **Type 2 - Network LSA** (Intra-Area)

        -   Generated by **DR**, area local scope, describes DR adjacent routers.

    -   **Type 3 - ASBR Network Summary LSA** (Inter-Area)

        -   Generated by **ABR,** sends list of networks in adjacent area, one LSA per network.
        -   Default route sent using Type 3 LSA

    -   **Type 4 - Summary ASBR LSA**

        -   Generated by **ABR,** tells members of an area how to reach ASBR.

    -   **Type 5 - External LSA**

        -   Generated by **ASBR,** network wide, goes to all non-stub areas.
        -   Describes routed the ASBR is redistributing.
        -   Type 1=E1 - Cost the ASBR reports plus cost to ASBR
        -   Type 2=E2 - Cost to the ASBR only, if tiebreak cost to ASBR included.

    -   **Type 7 - NSSA External LSA**

        -   

-   

-   Troubleshooting - **TAN MAT** (**T**imers, **A**rea, **N**etwork Add, **M**TU, **A**uth, **T**ype)

------------------------------------------------------------------------

# Features

## Authentication

-   Enabled per Interface or for all interfaces in an area

-   Plain text (pointless)

-   MD5 Hash - combination of key value + password.

-   

-   

## Virtual Links

-   Allows adjacency with non directly connected neighbour.

-   configured with:

``` default
R1(config)#router ospf 1
R1(config-router)#area 1 virtual-link 192.168.23.2     (IP of int in area you want to form adjacency with)

R2(config)#router ospf 1
R2(config-router)#area 1 virtual-link 1.1.1.1      (IP of int in area you want to form adjacency with)
```

links shows "DNA" in DB - Do Not Age - reduced traffic flowing over link - no hello or refresh messages.

## Summerisation

## Path Selection

Intra Area preferred

Inter Area next

Intra AREA

------------------------------------------------------------------------

# Useful commands

-   `show ip protocol` - shows general info on active routing protocols
-   `show ip ospf` -
-   `show ip ospf interface [brief]` - shows detailed info on OSFP enabled interfaces
-   `show ip ospf database` - shows the OSPF database for this area
-   `show ip ospf neighbour [detail]` - shows list of OSPF neighbours plus states
-   `show ip ospf database router self-originate`
-   

------------------------------------------------------------------------

# OSPF Configuration

``` default
router ospf 1                             - Process ID is locally significant
 router-id 1.1.1.1                        - Not an IP, just an ID.
 network 192.168.1.0 0.0.0.255 area 0     - Advertise interface within this network
 passive-interface default                - stops neighbour adjacency forming.
 no passive-interface gig 0/1             - int participates in ospf  

OR
 
int g0/2
ip ospf network point-to-point
ospf 1 area 0
```
